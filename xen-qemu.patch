qemu-xen-traditional/configure: define _GNU_SOURCE for NPTL defs
qemu-xen/configure: use -O2 for tests to eliminate fortify warnings (-Werror is in effect sometimes)
--- xen-4.2.0/tools/qemu-xen-traditional/configure.orig	2012-09-06 18:05:30.000000000 +0200
+++ xen-4.2.0/tools/qemu-xen-traditional/configure	2012-10-27 08:16:21.702515768 +0200
@@ -738,10 +738,10 @@
 #endif
 }
 EOF
 
-if $cc $ARCH_CFLAGS -c -o $TMPO $TMPC > /dev/null 2> /dev/null ; then
+if $cc $ARCH_CFLAGS -D_GNU_SOURCE -c -o $TMPO $TMPC > /dev/null 2> /dev/null ; then
   :
 else
    nptl="no"
 fi
 
@@ -788,7 +790,7 @@
         fi
 
         # static link with sdl ?
-        if test "$sdl" = "yes" ; then
+        if test "$static" = "yes" -a "$sdl" = "yes" ; then
             aa="no"
             `$sdl_config --static-libs 2>/dev/null | grep \\\-laa > /dev/null` && aa="yes"
             sdl_static_libs=`$sdl_config --static-libs 2>/dev/null`
--- xen-4.4.0/tools/qemu-xen/configure~	2014-02-05 16:59:14.000000000 +0000
+++ xen-4.4.0/tools/qemu-xen/configure	2014-03-12 13:53:34.947877721 +0000
@@ -342,10 +342,6 @@
 QEMU_CFLAGS="-Wstrict-prototypes -Wredundant-decls $QEMU_CFLAGS"
 QEMU_CFLAGS="-D_GNU_SOURCE -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE $QEMU_CFLAGS"
 QEMU_INCLUDES="-I. -I\$(SRC_PATH) -I\$(SRC_PATH)/include"
-if test "$debug_info" = "yes"; then
-    CFLAGS="-g $CFLAGS"
-    LDFLAGS="-g $LDFLAGS"
-fi
 
 # make source path absolute
 source_path=`cd "$source_path"; pwd`
@@ -3450,7 +3446,7 @@
   CFLAGS="-fprofile-arcs -ftest-coverage -g $CFLAGS"
   LDFLAGS="-fprofile-arcs -ftest-coverage $LDFLAGS"
 elif test "$debug" = "no" ; then
-  CFLAGS="-O2 -D_FORTIFY_SOURCE=2 $CFLAGS"
+  CFLAGS="-O2 $CFLAGS"
 fi
 
 
